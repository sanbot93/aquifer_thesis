<!DOCTYPE html>
<html>
<head>
  <title>Santiago Botero's Thesis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8">
  <!-- Load Leaflet from CDN -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
    crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
    integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
    crossorigin=""></script>

  <!-- Load Esri Leaflet from CDN -->
  <script src="https://unpkg.com/esri-leaflet@3.0.1/dist/esri-leaflet.js"
    integrity="sha512-JmpptMCcCg+Rd6x0Dbg6w+mmyzs1M7chHCd9W8HPovnImG2nLAQWn3yltwxXRM7WjKKFFHOAKjjF2SC4CgiFBg=="
    crossorigin=""></script>

  <nav>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="methods.html">Methods</a></li>
      <li><a href="results.html">Results and Conclusions</a></li>
      <li><a href="references.html">References and Resources</a></li>
       <li><a href="aboutme.html">About Me</a></li>
    </ul>
  </nav>
  
  <!-- Position the map and title with Cascading Style Sheet (CSS) -->
  <style>
  body { margin:100px; padding: 100px;}
  #map { height: 600px;
        width: 100% ; 
        margin: auto; }
  #map-title { position: relative; margin-top: 10px; margin-left: 50px; float: left; background: white; border: 2px solid rgba(0,0,0,0.2); padding: 6px 8px; font-family: Helvetica; font-weight: bold; font-size: 24px; z-index: 800; }
  </style>
</head>
<body>

  <!-- Display the map and title with HTML division tags  -->
  <div id="map-title">Aquifer Recharge Layers</div>
  <div id="map"></div>

  <script>
    // workaround for old ie
    if (!window.location.origin) {
      window.location.origin = window.location.protocol + '//' + window.location.hostname + (window.location.port ? ':' + window.location.port : '');
    }
    
    var map = L.map('map').setView([50.918619, -116.9], 7);
      L.esri.basemapLayer('Topographic').addTo(map);
    
      function serverAuth (callback) {
      L.esri.post('https://www.sgrc.selkirk.ca/gis-sandbox/tokens/generateToken', {
        username: 'GIS437',
        password: 'GIS437',
        f: 'json',
        expiration: 86400,
        client: 'referer',
        referer: window.location.origin
      }, callback);
    }

  serverAuth(function (error, response) {
    if (error) {
      return;
    }

    var dl = L.esri.tiledMapLayer({
      url: 'https://www.sgrc.selkirk.ca/gis-sandbox/rest/services/Sbotero/AquiferThesis/MapServer',
      token: response.token
    }).addTo(map);

    dl.on('authenticationrequired', function (e) {
      serverAuth(function (error, response) {
        if (error) {
          return;
        }

        e.authenticate(response.token);
      });
    });
  });
  </script>
      
</body>
</html>
